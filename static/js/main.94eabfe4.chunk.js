(this.webpackJsonpwebrtcsample=this.webpackJsonpwebrtcsample||[]).push([[0],[,,,,,function(e,t,n){e.exports={RtcStartComponentContainer:"RtcSample_RtcStartComponentContainer__1oqsr",Sdps:"RtcSample_Sdps__1VPlM",Description:"RtcSample_Description__1osy3"}},,,function(e,t,n){e.exports=n(16)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),c=n.n(o),i=(n(13),n(1)),s=n(2),l=n(4),u=n(3),d=(n(14),n(5)),m=n.n(d),p=function(e){return r.a.createElement("div",{className:m.a.Description},r.a.createElement("h2",null,"How to start"),r.a.createElement("ol",null,r.a.createElement("li",null,"[Transmitter] Click create button to create Transmitter SDP(Our SDP)."),r.a.createElement("li",null,"[Transmitter] Copy Transmitter SDP and sending it to Receiver via email,slack etc."),r.a.createElement("li",null,"[Receiver] Receive Transmitter SDP, and paste it to There SDP textarea and click receive button."),r.a.createElement("li",null,"[Receiver] Copy Receiver SDP(Our SDP) and sending it to Transmitter via email, slack etc."),r.a.createElement("li",null,"[Transmitter] Receive Receiver SDP, and paste it to There SDP textarea and click receive button."),r.a.createElement("li",null,"Tha's all. You can see their video.")))},v=function(e,t){var n=new RTCPeerConnection({iceServers:[]});return n.onicecandidate=function(t){t.candidate?console.log("onicecandidate",t.candidate):(console.log("empty ice event"),e(n.localDescription.sdp))},t&&(n.ontrack=t),n},h=function(e,t){switch(e){case"Transmitter":return void 0===t.ourSdp&&void 0!==t.pc;case"Receiver":return!1}},f=function(e,t){switch(e){case"Transmitter":return void 0!==t.ourSdp&&void 0!==t.pc;case"Receiver":return void 0!==t.pc}},S=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={ourSdp:void 0,thereSdp:void 0,pc:null},a}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:m.a.RtcStartComponentContainer},r.a.createElement("div",{className:m.a.Sdps},r.a.createElement("div",null,r.a.createElement("p",null,"Our SDP"),r.a.createElement("div",null,r.a.createElement("textarea",{readOnly:!0,placeholder:"Out SDP (click button below to create)",value:this.state.ourSdp})),r.a.createElement("button",{disabled:!h(this.props.mode,this.state),onClick:function(){var t=v((function(t){e.setState({ourSdp:t})}));e.props.onStart&&e.props.onStart(t),t.createOffer().then((function(e){console.log(e),t.setLocalDescription(e)})),e.setState({pc:t})}},"create")),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("p",null,"Their SDP"),r.a.createElement("textarea",{placeholder:"There SDP(click button below to receive)",onChange:function(t){e.setState({thereSdp:t.target.value})}})),r.a.createElement("button",{disabled:!f(this.props.mode,this.state),onClick:function(){if(e.state.pc)e.state.pc.setRemoteDescription(new RTCSessionDescription({type:"answer",sdp:e.state.thereSdp})).then((function(){console.log("setRemoteDescription(answer) succsess in promise")})).catch((function(e){console.error("setRemoteDescription(answer) ERROR: ",e)}));else{var t=v((function(t){e.setState({ourSdp:t})}),e.props.onTrack);t.setRemoteDescription(new RTCSessionDescription({type:"offer",sdp:e.state.thereSdp})).then((function(){console.log("setRemoteDescription(answer) succsess in promise")})).catch((function(e){console.error("setRemoteDescription(answer) ERROR: ",e)})),t.createAnswer().then((function(e){return console.log("createAnswer() succsess in promise",e),t.setLocalDescription(e)})).then((function(){console.log("setLocalDescription() succsess in promise")})).catch((function(e){console.error(e)})),e.setState({pc:t})}}},"receive"))))}}]),n}(r.a.Component),E=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).video=null,e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.update()}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"update",value:function(){console.log("update"),this.video&&this.props.stream&&(this.video.srcObject=this.props.stream)}},{key:"render",value:function(){var e=this;return r.a.createElement("video",{autoPlay:!0,onLoadedMetadata:function(e){console.log(e),e.target.play()},ref:function(t){e.video=t}})}}]),n}(r.a.Component),g=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={stream:null,sdp:void 0},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=navigator.getUserMedia.bind(navigator);e?e({audio:!1,video:{width:1280,height:720}},this.handleVideo.bind(this),(function(e){console.log("The following error occurred: "+e.name)})):console.log("getUserMedia not supported")}},{key:"handleVideo",value:function(e){this.setState({stream:e});var t=e.getVideoTracks(),n=e.getAudioTracks();t.length>0&&console.log("Using video device: ".concat(t[0].label)),n.length>0&&console.log("Using audio device: ".concat(n[0].label))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(p,{mode:"Transmitter"}),r.a.createElement(S,{mode:"Transmitter",onStart:function(t){console.log("send start"),e.state.stream.getTracks().forEach((function(n){console.log("add track",n,e.state.stream),t.addTrack(n,e.state.stream)}))}}),r.a.createElement(E,{stream:this.state.stream}))}}]),n}(r.a.Component),b=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={sdp:null,stream:null},a}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(p,{mode:"Receiver"}),r.a.createElement(S,{mode:"Receiver",onTrack:function(t){console.log("onTrack",t),e.setState({stream:t.streams[0]})}}),r.a.createElement("div",null,r.a.createElement(E,{stream:this.state.stream})))}}]),n}(r.a.Component),R=(n(15),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).modeSelector=r.a.createElement("div",null,r.a.createElement("select",{onChange:function(e){var t=e.target.value;"Transmitter"===t||"Receiver"===t?a.setState({mode:t}):a.setState({mode:null})}},r.a.createElement("option",{value:"Null"},"Mode Select"),r.a.createElement("option",{value:"Transmitter"},"Transmitter"),r.a.createElement("option",{value:"Receiver"},"Receiver"))),a.state={mode:null},a}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"WebRTC Sample Project using React.js (Mode:",this.state.mode,")"),"Transmitter"===this.state.mode?r.a.createElement(g,null):"Receiver"===this.state.mode?r.a.createElement(b,null):this.modeSelector)}}]),n}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[8,1,2]]]);
//# sourceMappingURL=main.94eabfe4.chunk.js.map